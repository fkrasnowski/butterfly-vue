var q=Object.defineProperty,R=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var L=(e,t,o)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,h=(e,t)=>{for(var o in t||(t={}))G.call(t,o)&&L(e,o,t[o]);if(I)for(var o of I(t))H.call(t,o)&&L(e,o,t[o]);return e},g=(e,t)=>R(e,W(t));import{d as E,a as N,c as K,r as b,o as J,b as y,e as C,f as x,F as A,g as V,u as f,n as Q,h as Z,i as P,j as z,m as w,k as ee,l as te,p as oe,q as u,w as O,s as j,t as a,v as d,x as p,y as $,z as ne,A as ae,B as se,C as de,D as re,E as le,G as ce}from"./vendor.ccefcf67.js";const ie=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}};ie();class ue extends E.exports.Node{draw(t){const o=document.getElementById(t.id);return o.style.top=`${t.top}px`,o.style.left=`${t.left}px`,o}}class _e extends E.exports.Endpoint{draw(t){return document.getElementById(t.id)}}const T=e=>g(h({},e),{Class:ue,endpoints:e.endpoints.map(t=>g(h({},t),{Class:_e}))}),pe=e=>g(h({},e),{Class:E.exports.Edge}),ve=e=>({nodes:e.nodes.map(T),edges:e.edges.map(pe)});var D=(e,t)=>{const o=e.__vccOpts||e;for(const[r,n]of t)o[r]=n;return o};const fe={class:"absolute-container"},me=N({props:{controller:null,config:null,containerClass:null,containerStyle:null},setup(e){const{controller:t,config:o,containerClass:r,containerStyle:n}=e,s=t._currentData,l=K(()=>s.value.nodes.flatMap(c=>c.endpoints)),_=b(null);return J(()=>{const c=new E.exports.Canvas(h({root:_.value},o));t._canvas.value=c,c.draw(ve(t.initialData)),c.on("events",m=>{console.log(m.type),m.type.startsWith("node")&&(s.value.nodes=[...c.getDataMap().nodes])})}),(c,m)=>(y(),C("div",{ref_key:"canvasRef",ref:_,class:Q(e.containerClass),style:Z(e.containerStyle)},[x("div",fe,[(y(!0),C(A,null,V(f(s).nodes,v=>P(c.$slots,"node",z(w({key:v.id},v)),void 0,!0)),128)),(y(!0),C(A,null,V(f(l),v=>P(c.$slots,"endpoint",z(w({key:v.id},v)),void 0,!0)),128))])],6))}});var he=D(me,[["__scopeId","data-v-40fe3780"]]);const M=Error("Canvas not attached, remember to pass controller down to Butterfly component"),ye=e=>{const t=b(e),o=b(null),r=te(e.nodes.reduce((l,_)=>g(h({},l),{[_.id]:_.nodeData}),{}));return{addNode:l=>{if(!o.value)throw M;t.value.nodes.push(l),r[l.id]=l.nodeData,oe(()=>{var _;return(_=o.value)==null?void 0:_.addNode(T(l))})},removeNode:l=>{if(!o.value)throw M;o.value.removeNode(l),delete r[l]},initialData:e,data:ee(t),nodesData:r,_currentData:t,_canvas:o}};function k(e){let t=e.changedTouches,o=t[0],r="";switch(e.type){case"touchstart":r="mousedown";break;case"touchmove":r="mousemove";break;case"touchend":r="mouseup";break;default:return}let n=new MouseEvent(r,{bubbles:!0,cancelable:!0,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});o.target.dispatchEvent(n),e.type==="touchmove"&&e.preventDefault()}const X={mounted(e){e.addEventListener("touchstart",k,!0),e.addEventListener("touchmove",k,!0),e.addEventListener("touchend",k,!0),e.addEventListener("touchcancel",k,!0)}};const ge=p("Delete"),be=p("Color"),xe=p("Pick color"),ke=p("Pick color of the node card"),Ce=p("Black"),$e=p("White"),we=N({props:{id:null,top:null,left:null,nodeData:null},emits:["delete","update:node-data"],setup(e,{emit:t}){const o=b(!1);return(r,n)=>{const s=u("v-card-header-text"),l=u("v-card-header"),_=u("v-card-text"),c=u("v-btn"),m=u("v-card-actions"),v=u("v-card"),S=u("v-dialog");return O((y(),j(v,{id:e.id,class:"card",color:e.nodeData.color},{default:a(()=>[d(l,null,{default:a(()=>[d(s,null,{default:a(()=>[p("Node "+$(e.id),1)]),_:1})]),_:1}),d(_,null,{default:a(()=>[p(" x: "+$(e.top)+" y: "+$(e.left),1)]),_:1}),d(m,null,{default:a(()=>[d(c,{variant:"text",color:"red",onClick:n[0]||(n[0]=i=>t("delete"))},{default:a(()=>[ge]),_:1}),d(S,{modelValue:o.value,"onUpdate:modelValue":n[4]||(n[4]=i=>o.value=i)},{activator:a(({props:i})=>[d(c,w({color:"deep-purple"},i),{default:a(()=>[be]),_:2},1040)]),default:a(()=>[d(v,null,{default:a(()=>[d(l,null,{default:a(()=>[d(s,null,{default:a(()=>[xe]),_:1})]),_:1}),d(_,null,{default:a(()=>[ke]),_:1}),d(m,{onClick:n[3]||(n[3]=i=>o.value=!1)},{default:a(()=>[d(c,{color:"black",onClick:n[1]||(n[1]=i=>t("update:node-data",{color:"black"}))},{default:a(()=>[Ce]),_:1}),d(c,{color:"white",onClick:n[2]||(n[2]=i=>t("update:node-data",{color:"white"}))},{default:a(()=>[$e]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["id","color"])),[[f(X),!0]])}}});var Ee=D(we,[["__scopeId","data-v-32af4fc2"]]);const Ne=e=>(ne("data-v-585a3f46"),e=e(),ae(),e),De=["id"],Se=Ne(()=>x("div",{class:"inner-dot"},null,-1)),Be=[Se],Ie=N({props:{id:null},setup(e){return(t,o)=>{const r=u("v-tooltip");return O((y(),C("div",{id:e.id,class:"wrapper"},[d(r,{anchor:"top"},{activator:a(({props:n})=>[x("div",w({class:"dot"},n),Be,16)]),default:a(()=>[x("span",null,"Endpoint: `"+$(e.id)+"` ",1)]),_:1})],8,De)),[[f(X),!0]])}}});var Le=D(Ie,[["__scopeId","data-v-585a3f46"]]);const Ae=p("Vue 3 + butterfly demo"),Ve=p("Add white node"),Pe=p("Add black node"),ze={class:"box"},Me=N({setup(e){const t=ye({nodes:[{id:"1",top:100,left:100,endpoints:[{id:"endpoint-1",orientation:[1,0]}],nodeData:{color:"white"}},{id:"2",top:200,left:400,endpoints:[{id:"endpoint-2",orientation:[-1,0]}],nodeData:{color:"white"}}],edges:[]}),o=b(3),r=(n,s)=>t.addNode({id:n,top:20,left:20,endpoints:[{id:`node-${n}-endpoint-1`,orientation:[1,0]},{id:`node-${n}-endpoint-2`,orientation:[-1,0]}],nodeData:{color:s}});return(n,s)=>{const l=u("v-app-bar-title"),_=u("v-app-bar"),c=u("v-btn"),m=u("v-btn-group"),v=u("v-main"),S=u("v-app");return y(),j(S,null,{default:a(()=>[d(_,null,{default:a(()=>[d(l,null,{default:a(()=>[Ae]),_:1})]),_:1}),d(v,{style:{padding:"2rem 0"}},{default:a(()=>[d(m,{color:"deep-purple"},{default:a(()=>[d(c,{onClick:s[0]||(s[0]=i=>r((o.value++).toString(),"white"))},{default:a(()=>[Ve]),_:1}),d(c,{onClick:s[1]||(s[1]=i=>r((o.value++).toString(),"black"))},{default:a(()=>[Pe]),_:1})]),_:1}),x("div",ze,[d(f(he),{controller:f(t),"container-class":"canvas",config:{moveable:!0,disLinkable:!0,linkable:!0,draggable:!0,zoomable:!1,moveable:!0,theme:{edge:{arrow:!0,shapeType:"AdvancedBezier"}}}},{node:a(({id:i,top:F,left:U})=>[d(Ee,{id:i,"node-data":f(t).nodesData[i],"onUpdate:node-data":B=>f(t).nodesData[i]=B,top:F,left:U,onDelete:B=>f(t).removeNode(i)},null,8,["id","node-data","onUpdate:node-data","top","left","onDelete"])]),endpoint:a(({id:i})=>[d(Le,{id:i},null,8,["id"])]),_:1},8,["controller"])])]),_:1})]),_:1})}}});var Oe=D(Me,[["__scopeId","data-v-7034949b"]]);const Y=se(Oe),je=de({components:re,directives:le,icons:{defaultSet:"mdi",sets:{mdi:ce}}});Y.use(je);Y.mount("#app");
